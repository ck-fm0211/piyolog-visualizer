# スクリプト群のREADME

このドキュメントでは、Google Apps Scriptを使用してGoogle Drive内の最新ファイルのデータを解析し、その内容をGoogleスプレッドシートに転記するスクリプト群について説明します。

## 概要

このスクリプト群は、特定のGoogle Driveフォルダ内の最新ファイルを検索し、その内容を解析してGoogleスプレッドシートに記録します。ログファイルの解析、データの整形、スプレッドシートへの書き込みなどの機能が含まれています。

## スクリプト構成

- `index.ts`: メインのスクリプトファイル。プロセスの開始点です。
- `fileHandler.ts`: Google Driveから最新のファイルを取得し、その内容を読み込むための関数を含みます。
- `logParser.ts`: ログファイルの内容を解析し、必要なデータを抽出するための関数を含みます。
- `spreadsheetHandler.ts`: 解析したデータをGoogleスプレッドシートに書き込むための関数を含みます。

## 機能

1. **ファイルの読み込み**: Google Driveの指定されたフォルダから最新のファイルを検索し、その内容を取得します。
2. **ログ解析**: ファイルの内容を解析し、日付、時間、アクティビティなどの情報を抽出します。
3. **スプレッドシートへの書き込み**: 解析したデータをスプレッドシートに整形して書き込みます。また、重複データの排除やアクティビティごとのシート作成も行います。

## 使用方法

1. Google Apps Scriptプロジェクトを作成します。
2. 上記のスクリプトファイルをプロジェクトに追加します。
3. スクリプトのプロパティに`folderId`（Google DriveのフォルダID）と`spreadsheetId`（スプレッドシートのID）を設定します。
4. `index.ts`の`main`関数を実行してプロセスを開始します。

## 注意事項

- スクリプトを実行するには、Google DriveとGoogleスプレッドシートへのアクセス権が必要です。
- `folderId`と`spreadsheetId`は、スクリプトのプロパティとして正しく設定する必要があります。
- スプレッドシートには`Data`という名前のシートが必要です。存在しない場合は新しく作成されます。

## ライセンス

このスクリプト群は[MITライセンス](https://opensource.org/licenses/MIT)の下で公開されています。
